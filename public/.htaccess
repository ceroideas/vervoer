# 🚀 Configuración Proxy - Vervoer
# Para Plesk con Apache

# Habilitar módulos necesarios
<IfModule mod_proxy.c>
    <IfModule mod_proxy_http.c>
        
        # Configurar proxy a la aplicación Next.js
        ProxyPreserveHost On
        ProxyPass / http://localhost:3000/
        ProxyPassReverse / http://localhost:3000/
        
        # Headers para WebSocket
        RewriteEngine On
        RewriteCond %{HTTP:Upgrade} websocket [NC]
        RewriteCond %{HTTP:Connection} upgrade [NC]
        RewriteRule ^/?(.*) "ws://localhost:3000/$1" [P,L]
        
        # Headers de seguridad
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set X-XSS-Protection "1; mode=block"
        Header always set X-Content-Type-Options "nosniff"
        Header always set Referrer-Policy "no-referrer-when-downgrade"
        
        # Configuración de caché para archivos estáticos
        <LocationMatch "^/_next/static/">
            Header set Cache-Control "public, max-age=31536000, immutable"
        </LocationMatch>
        
        <LocationMatch "\.(ico|css|js|gif|jpe?g|png|svg|woff|woff2|ttf|eot)$">
            Header set Cache-Control "public, max-age=31536000"
        </LocationMatch>
        
    </IfModule>
</IfModule>

# Si no tienes mod_proxy, redirigir a puerto 3000
<IfModule !mod_proxy.c>
    RewriteEngine On
    RewriteRule ^(.*)$ http://localhost:3000/$1 [P,L]
</IfModule>

# Configuración de errores
ErrorDocument 502 "La aplicación no está disponible. Por favor, verifica que esté ejecutándose en el puerto 3000."
ErrorDocument 503 "La aplicación está en mantenimiento. Por favor, intenta más tarde." 