#  Configuraci贸n Proxy - Vervoer
# Para Plesk con Apache

# Habilitar m贸dulos necesarios
<IfModule mod_proxy.c>
    <IfModule mod_proxy_http.c>
        
        # Configurar proxy a la aplicaci贸n Next.js
        ProxyPreserveHost On
        ProxyPass / http://localhost:3000/
        ProxyPassReverse / http://localhost:3000/
        
        # Headers para WebSocket
        RewriteEngine On
        RewriteCond %{HTTP:Upgrade} websocket [NC]
        RewriteCond %{HTTP:Connection} upgrade [NC]
        RewriteRule ^/?(.*) "ws://localhost:3000/$1" [P,L]
        
        # Headers de seguridad
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set X-XSS-Protection "1; mode=block"
        Header always set X-Content-Type-Options "nosniff"
        Header always set Referrer-Policy "no-referrer-when-downgrade"
        
        # Configuraci贸n de cach茅 para archivos est谩ticos
        <LocationMatch "^/_next/static/">
            Header set Cache-Control "public, max-age=31536000, immutable"
        </LocationMatch>
        
        <LocationMatch "\.(ico|css|js|gif|jpe?g|png|svg|woff|woff2|ttf|eot)$">
            Header set Cache-Control "public, max-age=31536000"
        </LocationMatch>
        
    </IfModule>
</IfModule>

# Si no tienes mod_proxy, redirigir a puerto 3000
<IfModule !mod_proxy.c>
    RewriteEngine On
    RewriteRule ^(.*)$ http://localhost:3000/$1 [P,L]
</IfModule>

# Configuraci贸n de errores
ErrorDocument 502 "La aplicaci贸n no est谩 disponible. Por favor, verifica que est茅 ejecut谩ndose en el puerto 3000."
ErrorDocument 503 "La aplicaci贸n est谩 en mantenimiento. Por favor, intenta m谩s tarde." 